<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒã‚¹ã‚³ãƒƒãƒˆèƒŒæ™¯é™¤å»ãƒ„ãƒ¼ãƒ«</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Meiryo, sans-serif;
      padding: 24px;
      max-width: 700px;
      margin: 0 auto;
    }
    h1 { font-size: 1.4rem; margin-bottom: 12px; }
    p { color: #555; margin-bottom: 20px; font-size: 0.9rem; line-height: 1.6; }
    .card {
      background: #f8faf9;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      border: 1px solid #e0e8e4;
    }
    .card h2 { font-size: 1rem; margin-bottom: 12px; color: #5a9b7d; }
    .drop-zone {
      border: 2px dashed #7eb89a;
      border-radius: 12px;
      padding: 32px;
      text-align: center;
      background: #fff;
      cursor: pointer;
      transition: all 0.2s;
    }
    .drop-zone:hover { background: #f0f8f4; }
    input[type="file"] { display: none; }
    #preview { margin: 16px 0; text-align: center; }
    #preview img {
      max-width: 100%;
      max-height: 250px;
      border-radius: 8px;
    }
    button {
      padding: 12px 24px;
      background: #7eb89a;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 12px;
      font-size: 0.95rem;
    }
    button:hover { background: #5a9b7d; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    #status { margin: 12px 0; color: #666; font-size: 0.9rem; min-height: 24px; }
    .result-area {
      margin-top: 20px;
      padding: 20px;
      background: #fff;
      border-radius: 12px;
      border: 1px solid #e0e8e4;
      display: none;
    }
    .result-area.show { display: block; }
    .result-area img {
      max-width: 100%;
      display: block;
      margin: 0 auto 16px;
      background: repeating-conic-gradient(#ccc 0% 25%, #eee 0% 50%) 50% / 16px 16px;
      border-radius: 8px;
    }
    .links { margin-top: 24px; }
    .links a {
      color: #7eb89a;
      text-decoration: none;
      display: block;
      margin: 8px 0;
    }
    .links a:hover { text-decoration: underline; }
    .note { font-size: 0.85rem; color: #888; margin-top: 8px; }
  </style>
</head>
<body>
  <h1>ğŸ–¼ï¸ ãƒã‚¹ã‚³ãƒƒãƒˆèƒŒæ™¯é™¤å»ãƒ„ãƒ¼ãƒ«</h1>
  <p>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç«‹ã¡çµµéƒ¨åˆ†ã‚’åˆ‡ã‚ŠæŠœã„ã¦ã€é€éPNGã¨ã—ã¦ä¿å­˜ã§ãã¾ã™ã€‚</p>
  
  <div class="card">
    <h2>æ–¹æ³•1: ã‚·ãƒ³ãƒ—ãƒ«é™¤å»ï¼ˆç™½èƒŒæ™¯å‘ã‘ï¼‰</h2>
    <p>èƒŒæ™¯ãŒç™½ã¾ãŸã¯å˜è‰²ã«è¿‘ã„ç”»åƒå‘ã‘ã€‚ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å³æ™‚å‡¦ç†ã—ã¾ã™ã€‚</p>
    <div class="drop-zone" id="dropZone">
      <p>ğŸ“ ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°ã§ç”»åƒã‚’é¸æŠ</p>
      <input type="file" id="fileInput" accept="image/*">
    </div>
    <div id="preview"></div>
    <div id="status"></div>
    <button id="removeBtn" disabled>èƒŒæ™¯ã‚’é™¤å»ã—ã¦åˆ‡ã‚ŠæŠœã</button>
    
    <div class="result-area" id="resultArea">
      <p><strong>âœ¨ å®Œæˆ</strong></p>
      <img id="resultImg" alt="çµæœ">
      <a id="downloadBtn" download="mascot-cutout.png">
        <button>ğŸ’¾ PNGã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
      </a>
    </div>
  </div>
  
  <div class="card">
    <h2>æ–¹æ³•2: AIé™¤å»ï¼ˆè¤‡é›‘ãªèƒŒæ™¯å‘ã‘ï¼‰</h2>
    <p>èƒŒæ™¯ãŒè¤‡é›‘ãªå ´åˆã¯ã€ä»¥ä¸‹ã®ç„¡æ–™ãƒ„ãƒ¼ãƒ«ãŒãŠã™ã™ã‚ã§ã™ã€‚</p>
    <ul style="margin-left: 20px; margin-bottom: 12px;">
      <li><a href="https://www.remove.bg/ja" target="_blank">remove.bg</a> - é«˜ç²¾åº¦ã€ç„¡æ–™æ ã‚ã‚Š</li>
      <li><a href="https://photoscissors.com/" target="_blank">PhotoScissors</a> - ç›´æ„Ÿçš„ãªæ“ä½œ</li>
    </ul>
    <p class="note">ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã ã‘ã§ã€AIãŒè‡ªå‹•ã§åˆ‡ã‚ŠæŠœãã¾ã™ã€‚</p>
  </div>

  <script>
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('fileInput');
    const preview = document.getElementById('preview');
    const status = document.getElementById('status');
    const removeBtn = document.getElementById('removeBtn');
    const resultArea = document.getElementById('resultArea');
    const resultImg = document.getElementById('resultImg');
    const downloadBtn = document.getElementById('downloadBtn');

    let currentFile = null;

    dropZone.addEventListener('click', () => fileInput.click());
    dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.style.background = '#f0f8f4'; });
    dropZone.addEventListener('dragleave', () => { dropZone.style.background = '#fff'; });
    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.style.background = '#fff';
      if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
    });
    fileInput.addEventListener('change', (e) => {
      if (e.target.files.length) handleFile(e.target.files[0]);
    });

    function handleFile(file) {
      currentFile = file;
      preview.innerHTML = `<img src="${URL.createObjectURL(file)}" alt="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">`;
      removeBtn.disabled = false;
      status.textContent = '';
      resultArea.classList.remove('show');
    }

    removeBtn.addEventListener('click', () => {
      if (!currentFile) return;
      removeBtn.disabled = true;
      status.textContent = 'â³ å‡¦ç†ä¸­...';

      const img = new Image();
      img.crossOrigin = 'anonymous';
      img.onload = () => {
        const canvas = document.createElement('canvas');
        canvas.width = img.width;
        canvas.height = img.height;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0);

        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const data = imageData.data;

        // ç™½ã«è¿‘ã„è‰²ã‚’é€éï¼ˆé–¾å€¤ã§èª¿æ•´ï¼‰
        const threshold = 240;
        const tolerance = 30;

        for (let i = 0; i < data.length; i += 4) {
          const r = data[i];
          const g = data[i + 1];
          const b = data[i + 2];
          const a = data[i + 3];

          const brightness = (r + g + b) / 3;
          const isWhite = r > threshold && g > threshold && b > threshold;

          if (isWhite) {
            data[i + 3] = 0;
          } else if (brightness > 250) {
            const factor = (255 - brightness) / 15;
            data[i + 3] = Math.round(255 * Math.max(0, factor));
          }
        }

        ctx.putImageData(imageData, 0, 0);

        canvas.toBlob((blob) => {
          const url = URL.createObjectURL(blob);
          resultImg.src = url;
          downloadBtn.href = url;
          downloadBtn.download = 'mascot-cutout.png';
          resultArea.classList.add('show');
          status.textContent = 'âœ… å®Œäº†ï¼èƒŒæ™¯ãŒé€éã•ã‚Œã¾ã—ãŸ';
        }, 'image/png');
      };
      img.onerror = () => {
        status.textContent = 'âŒ ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ';
      };
      img.src = URL.createObjectURL(currentFile);
      removeBtn.disabled = false;
    });
  </script>
</body>
</html>
